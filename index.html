<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Flappy Bat â€“ Average Mode</title>

<meta name="viewport"
content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

<style>
html, body {
  margin: 0;
  padding: 0;
  width: 100%;
  height: 100%;
  overflow: hidden;
  background: black;
}

canvas {
  display: block;
}
</style>
</head>

<body>
<canvas id="game"></canvas>

<script>
/* ======================
   SETUP
====================== */
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");

function resize() {
  canvas.width = window.innerWidth;
  canvas.height = window.innerHeight;
}
resize();
window.addEventListener("resize", resize);

/* ======================
   AVERAGE MODE SETTINGS
====================== */
let gravity = 0.5;        // heavier than easy
let jumpPower = -10.5;    // weaker jump
let speed = 3;            // faster obstacles
let gap = 150;            // tighter gap

let score = 0;
let gameOver = false;

/* ======================
   PLAYER
====================== */
let bat = {
  x: canvas.width * 0.25,
  y: canvas.height / 2,
  r: 14,
  vy: 0
};

/* ======================
   OBSTACLES
====================== */
let pipes = [];
let width = 70;

function spawnPipe() {
  let y = Math.random() * (canvas.height - 280) + 140;
  pipes.push({ x: canvas.width, y, passed: false });
}
setInterval(spawnPipe, 1700);

/* ======================
   INPUT
====================== */
document.addEventListener("touchstart", flap);
document.addEventListener("mousedown", flap);

function flap(e) {
  e.preventDefault();

  if (gameOver) {
    reset();
    return;
  }

  // remove downward momentum
  if (bat.vy > 0) bat.vy = 0;
  bat.vy += jumpPower;
}

/* ======================
   RESET
====================== */
function reset() {
  score = 0;
  pipes = [];
  bat.y = canvas.height / 2;
  bat.vy = 0;
  gameOver = false;
}

/* ======================
   UPDATE
====================== */
function update() {
  if (gameOver) return;

  bat.vy += gravity;
  bat.y += bat.vy;

  if (bat.y < 0 || bat.y > canvas.height) {
    gameOver = true;
  }

  pipes.forEach(p => {
    p.x -= speed;

    if (!p.passed && p.x + width < bat.x) {
      score++;
      p.passed = true;
    }

    if (
      bat.x + bat.r > p.x &&
      bat.x - bat.r < p.x + width &&
      (bat.y - bat.r < p.y - gap / 2 ||
       bat.y + bat.r > p.y + gap / 2)
    ) {
      gameOver = true;
    }
  });

  pipes = pipes.filter(p => p.x + width > 0);
}

/* ======================
   DRAW
====================== */
function draw() {
  // Gotham background
  let bg = ctx.createLinearGradient(0, 0, 0, canvas.height);
  bg.addColorStop(0, "#020202");
  bg.addColorStop(1, "#1a1a1a");
  ctx.fillStyle = bg;
  ctx.fillRect(0, 0, canvas.width, canvas.height);

  // Bat orb
  ctx.shadowBlur = 18;
  ctx.shadowColor = "#FFD700";
  ctx.beginPath();
  ctx.arc(bat.x, bat.y, bat.r, 0, Math.PI * 2);
  ctx.fillStyle = "#FFD700";
  ctx.fill();
  ctx.shadowBlur = 0;

  // Pipes
  pipes.forEach(p => {
    ctx.fillStyle = "#0d0d0d";
    ctx.fillRect(p.x, 0, width, p.y - gap / 2);
    ctx.fillRect(p.x, p.y + gap / 2, width, canvas.height);

    ctx.strokeStyle = "#FFD700";
    ctx.lineWidth = 2;
    ctx.strokeRect(p.x, 0, width, p.y - gap / 2);
    ctx.strokeRect(p.x, p.y + gap / 2, width, canvas.height);
  });

  // Score
  ctx.fillStyle = "#FFD700";
  ctx.font = "bold 32px Arial";
  ctx.textAlign = "center";
  ctx.fillText(score, canvas.width / 2, 60);

  // Game over
  if (gameOver) {
    ctx.fillStyle = "rgba(0,0,0,0.75)";
    ctx.fillRect(0, 0, canvas.width, canvas.height);

    ctx.fillStyle = "#FFD700";
    ctx.font = "32px Arial Black";
    ctx.fillText("Don't work too hard ConðŸ¦‡", canvas.width / 2, canvas.height / 2);

    ctx.font = "18px Arial";
    ctx.fillText("Tap to Try Again", canvas.width / 2, canvas.height / 2 + 40);
  }
}

/* ======================
   LOOP
====================== */
function loop() {
  update();
  draw();
  requestAnimationFrame(loop);
}
loop();
</script>

</body>
</html>
